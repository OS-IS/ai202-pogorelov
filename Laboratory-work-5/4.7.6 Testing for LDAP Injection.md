### 4.7.6 Тестування на LDAP Injection

**LDAP Injection** — це вразливість, що виникає, коли вебдодаток некоректно обробляє користувацькі введення, дозволяючи зловмисникам змінювати LDAP-запити. Lightweight Directory Access Protocol (LDAP) використовується для пошуку та модифікації інформації у каталозі, і, якщо введені дані не проходять коректну обробку, вони можуть призвести до виконання небажаних операцій.

LDAP Injection може дозволити зловмисникам:
- обійти аутентифікацію та авторизацію;
- переглянути обмежені дані;
- змінювати інформацію в каталозі;
- запускати атаки на відмову в обслуговуванні.

#### Методи тестування LDAP Injection

##### Крок 1: Виявлення точок входу

Першим кроком є виявлення точок у вебзастосунку, де користувацькі введення передаються до LDAP-запиту. Це можуть бути поля для введення даних, такі як ім'я користувача, прізвище, електронна адреса тощо.

##### Крок 2: Введення спеціальних символів

Введіть спеціальні символи LDAP, щоб визначити, чи обробляються введені дані належним чином. Приклади таких символів включають:
- `*` (використовується для розширеного пошуку);
- `&` (оператор "AND");
- `|` (оператор "OR");
- `=` (оператор призначення);
- `()` (для групування умов).

##### Крок 3: Аналіз відповіді сервера

Якщо сервер відповідає без помилок або якщо запити виконуються в зміненому вигляді, це може свідчити про вразливість до LDAP Injection. Звертайте увагу на зміну поведінки застосунку.

#### Інструменти для тестування LDAP Injection

Використовуйте інструменти, такі як **Burp Suite**, **OWASP ZAP** та інші проксі-інструменти для перехоплення запитів та маніпуляції ними. Вони допоможуть аналізувати запити LDAP, відправлені серверу.

#### Приклад атаки LDAP Injection

Уявімо, що вебдодаток виконує запит на автентифікацію користувача з обліковими даними, які вводить користувач. Якщо користувач вводить `*)(uid=*))(|(uid=*)`, це може призвести до успішного обходу перевірки, оскільки запит тепер приймає будь-яке значення `uid`.

#### Запобігання LDAP Injection

1. **Валідація введених даних**: Переконайтеся, що всі введені користувачем дані відповідають очікуваному формату.
2. **Використання параметризованих запитів**: Використовуйте параметризовані LDAP-запити для запобігання ін'єкціям.
3. **Екранування спеціальних символів**: Видаляйте або екрануйте символи `*`, `&`, `|`, `=`, `(` та `)`.
4. **Обмеження прав доступу**: Обмежте доступ до LDAP тільки необхідними правами для зниження ризику несанкціонованих операцій.

LDAP Injection може бути серйозною загрозою для конфіденційності та цілісності інформації в каталозі. Постійна валідація введених даних та використання безпечних методів доступу до LDAP дозволить мінімізувати ризики.

